---
title: "Quick start"
author: "Martin O'Reilly"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Quick start}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
## End to end NetEMD example
```{r, fig.show='hold'}
library("netdist")
# Load example virus PPI graphs in indexed edge list form
data("virusppi", package = "netdist")

# This contains PPI graphs for 5 viruses
attr(virusppi, "names")

# Calculate graphlet orbit degree distributions up to 4 nodes for all graphs 
# This only needs to be done once per graph
virus_godd <- purrr::map(virusppi, godd)

# Generate a cross-comparison matrix listing all combinations of graphs
comp_spec <- graph_cross_comparison_spec(virusppi)
comp_spec[1:5,]

# Compute NetEMD between all virus PPI graphs based on all graphlet orbir
# degree distributions up to 4 nodes
net_emds <- purrr::simplify(
  purrr::map2(comp_spec$index_a, comp_spec$index_b, function(index_a, index_b) {
  net_emd(virus_godd[[index_a]], virus_godd[[index_b]])
}))

# Link NetEMDs with their respective comp_specs
comp_spec$net_emd = net_emds
print(comp_spec)

# Confirm NetEMD of a graph with itself is zero within (or at least close to)
# the limits of machine precision
purrr::map2(virus_godd, virus_godd, net_emd)
.Machine$double.eps
```

